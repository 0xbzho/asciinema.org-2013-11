{"ID":6455,"Author":{"Name":"mattboehm","ID":0,"FullName":"","Gravatar":"176aa7774853497078afa7e41cdcf729"},"Title":"Vim Magic: removing duplicate lines with shell filtering and macros","Description":"\u003cdiv class=\"content\"\u003e\u003cp\u003eWhile working on a PR for \u003ca href=\"https://github.com/dbakker/vim-lint\"\u003evim-lint\u003c/a\u003e, I ran into an interesting problem: a file that lists ex commands had some duplicates, as it contained both \u003ccode\u003eabo[veleft]\u003c/code\u003e and \u003ccode\u003eaboveleft\u003c/code\u003e even though only the first was necessary. \u003c/p\u003e\n\n\u003cp\u003eHere\u0026#39;s how I fixed it:\u003c/p\u003e\n\n\u003cpre\u003e\u003ccode\u003e\u0026#34;copy all text\nggyG \n\u0026#34;open new split and paste\n:vnew\np\n\u0026#34;delete [ , ]\n:%s;\\[\\|\\];;g\n\u0026#34;filter through sort/uniq -d to only get duplicate lines\n:%!sort | uniq -d\n\u0026#34;switch to original window\n\u0026lt;c-w\u0026gt;w\n\u0026#34;start recording a macro in register a\nqa\n    \u0026#34;back to scratch window\n    \u0026lt;c-w\u0026gt;w\n    \u0026#34;jump to first line, delete\n    ggdd\n    \u0026#34;jump back to main window\n    \u0026lt;c-w\u0026gt;w\n    \u0026#34;search for the thing I just deleted (backspace the newline char at end)\n    /\u0026lt;c-r\u0026gt;\u0026#34;\u0026lt;backspace\u0026gt;\u0026lt;enter\u0026gt;\n    \u0026#34;delete it\n    dd\n\u0026#34;stop recording macro\nq\n\u0026#34;repeat macro 99 times. there are only 48 lines, but when it finishes the last one,\n\u0026#34;it errors out and just stops the loop.\n99@a\n\u003c/code\u003e\u003c/pre\u003e\n\n\u003chr/\u003e\n\n\u003cp\u003eedit: I had a bug; I should have put a $ at the end of the pattern being searched for. Ideally I\u0026#39;d use \u0026#34; but here this wasn\u0026#39;t an issue.\u003c/p\u003e\n\u003c/div\u003e","Time":"2013-11-20T06:41:19Z","Tags":["Linux","bash","screen"]}